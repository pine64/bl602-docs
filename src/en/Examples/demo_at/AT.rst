==============
AT Commands Introduction
==============
This article introduces the Bouffalo Labs AT command set and usage. The command set includes: basic AT commands, Wi-Fi function AT commands, TCP/IP toolbox AT commands, and BLE related AT commands.


.. table:: Command Types

    +------------+---------------+------------------------------------------+
    |  Type      | Format        | Description                              |
    +============+===============+==========================================+
    | Read       | AT+<x>?       | Get current value of command parameters  |
    +------------+---------------+------------------------------------------+
    | Set        | AT+<x>=<···>  | Set value of command parameters          |
    +------------+---------------+------------------------------------------+
    | Execute    | AT+<x>        | Execute a command                        |
    +------------+---------------+------------------------------------------+

==================
Basic AT Commands
==================

Overview
=================
.. table:: Command List

    +----------------------+------------------------------------------+
    |  Command             | Description                              |
    +======================+==========================================+
    | `AT+UART`_           | Set UART configuration                   |
    +----------------------+------------------------------------------+
    | `AT+GMR`_            | View version information                 |
    +----------------------+------------------------------------------+
    | `AT+S.HELP`_         | View AT help                             |
    +----------------------+------------------------------------------+
    | `AT+RST`_            | Restart the module                       |
    +----------------------+------------------------------------------+
    | `AT+RESTORE`_        | Reset                                    |
    +----------------------+------------------------------------------+
    | `AT+GSLP`_           | Enter deep-sleep                         |
    +----------------------+------------------------------------------+

Description
===================
AT+UART
---------

    +----------+--------------------------------------------------------------------+------------------------------------------------------------------+
    | Commands | Read Command                                                       | Set Command                                                      |
    +          +                                                                    +                                                                  +
    |          | AT+UART?                                                           | AT+UART=<baudrate>,<databits>,<stopbits>,<parity>,<flow control> |
    +----------+--------------------------------------------------------------------+------------------------------------------------------------------+
    | Response | +UART_CUR:<baudrate>,<databits>,<stopbits>,<parity>,<flow control> | OK                                                               |
    +          +                                                                    +                                                                  +
    |          | OK                                                                 |                                                                  |
    +----------+--------------------------------------------------------------------+------------------------------------------------------------------+
    |Parameters| - <baudrate>: UART baud rate                                                                                                          |
    +          +                                                                                                                                       +
    |          | - <databits>: number of data bits                                                                                                     |
    +          +                                                                                                                                       +
    |          |   * 5: 5-bit                                                                                                                          |
    +          +                                                                                                                                       +
    |          |   * 6: 6-bit                                                                                                                          |
    +          +                                                                                                                                       +
    |          |   * 7: 7-bit                                                                                                                          |
    +          +                                                                                                                                       +
    |          |   * 8: 8-bit                                                                                                                          |
    +          +                                                                                                                                       +
    |          | - <stopbits>: number of stop bits                                                                                                     |
    +          +                                                                                                                                       +
    |          |   * 1: 1-bit                                                                                                                          |
    +          +                                                                                                                                       +
    |          |   * 2: 1.5-bit                                                                                                                        |
    +          +                                                                                                                                       +
    |          |   * 3: 2-bit                                                                                                                          |
    +          +                                                                                                                                       +
    |          | - <parity>:                                                                                                                           |
    +          +                                                                                                                                       +
    |          |   * 0: None                                                                                                                           |
    +          +                                                                                                                                       +
    |          |   * 1: Odd                                                                                                                            |
    +          +                                                                                                                                       +
    |          |   * 2: Even                                                                                                                           |
    +          +                                                                                                                                       +
    |          | - <flow control>:                                                                                                                     |
    +          +                                                                                                                                       +
    |          |   * 0: Disabled                                                                                                                       |
    +          +                                                                                                                                       +
    |          |   * 1: Enable RTS                                                                                                                     |
    +          +                                                                                                                                       +
    |          |   * 2: Enable CTS                                                                                                                     |
    +          +                                                                                                                                       +
    |          |   * 3: Enable RTS & CTS                                                                                                               |
    +----------+---------------------------------------------------------------------------------------------------------------------------------------+

AT+GMR
----------

    +----------------------+-----------------------------------------------------------------+
    | Command              | AT+GMR                                                          |
    +----------------------+-----------------------------------------------------------------+
    | Response             | <AT version info>                                               |
    +                      +                                                                 +
    |                      | <SDK version info>                                              |
    +                      +                                                                 +
    |                      | <compile time>                                                  |
    +                      +                                                                 +
    |                      | OK                                                              |
    +----------------------+-----------------------------------------------------------------+


AT+RST
---------

    +----------------------+--------------+
    |  Command             | AT+RST       |
    +----------------------+--------------+
    | Response             | OK           |
    +----------------------+--------------+

AT+RESTORE
------------

    +----------------------+--------------+
    |  Command             | AT+RESTORE   |
    +----------------------+--------------+
    | Response             | OK           |
    +----------------------+--------------+

AT+S.HELP
------------

    +----------------------+--------------+
    |  Command             | AT+S.HELP    |
    +----------------------+--------------+
    | Response             | OK           |
    +----------------------+--------------+

AT+GSLP
-----------

    +----------+-------------------------------------------------------------------------------+
    |  Command |  AT+GSLP=<time>                                                               |
    +----------+-------------------------------------------------------------------------------+
    | Response | <time>                                                                        |
    +          +                                                                               +
    |          | OK                                                                            |
    +----------+-------------------------------------------------------------------------------+
    |Parameters| - <time>: Sleep duration in seconds. BL602 will wake up after time has elapsed|
    +----------+-------------------------------------------------------------------------------+

====================
Wi-Fi AT Commands
====================
Overview
=================
.. table:: Command List

    +------------------+------------------------------------------+
    |  Command         | Description                              |
    +------------------+------------------------------------------+
    | `AT+CWMODE`_     | Set Wi-Fi Mode (STA/AP/STA+AP)           |
    +------------------+------------------------------------------+
    | `AT+CWLAP`_      | Scan for nearby APs                      |
    +------------------+------------------------------------------+
    | `AT+CWJAP`_      | Connect to AP                            |
    +------------------+------------------------------------------+
    | `AT+CWQAP`_      | Disconnect from AP                       |
    +------------------+------------------------------------------+
    | `AT+CWAUTOCONN`_ | Set up automatic reconnection            |
    +------------------+------------------------------------------+
    | `AT+SOFTAP`_     | Turn on an AP hotspot                    |
    +------------------+------------------------------------------+

Description
===================
AT+CWMODE
------------

    +----------+----------------------------------+----------------------------------------------------------------------+
    |  Command | Read Command                     | Set Command                                                          |
    +          +                                  +                                                                      +
    |          | AT+CWMODE?                       | AT+CWMODE=<mode>                                                     |
    +          +                                  +                                                                      +
    |          | Purpose: Read current Wi-Fi mode | Purpose: Set current Wi-Fi mode                                      |
    +----------+----------------------------------+----------------------------------------------------------------------+
    | Response | +CWMODE:<mode>                   | OK                                                                   |
    +----------+----------------------------------+----------------------------------------------------------------------+
    |Parameters| - <mode>:                                                                                               |
    +          +                                                                                                         +
    |          |    * 0: Wi-Fi disabled, Wi-Fi RF turned off                                                             |
    +          +                                                                                                         +
    |          |    * 1: Station mode                                                                                    |
    +          +                                                                                                         +
    |          |    * 2: SoftAP mode                                                                                     |
    +          +                                                                                                         +
    |          |    * 3: SoftAP+Station mode                                                                             |
    +----------+---------------------------------------------------------------------------------------------------------+

AT+CWLAP
----------

    +----------+-------------------------------------------------------------------------------------------------+
    |  Command | Execute command                                                                                 |
    +          +                                                                                                 +
    |          | AT+CWLAP                                                                                        |
    +          +                                                                                                 +
    |          | Purpose: Scan for nearby access points                                                          |
    +----------+-------------------------------------------------------------------------------------------------+
    | Response | +CWLAP:                                                                                         |
    +          +                                                                                                 +
    |          | <ap list>...                                                                                    |
    +          +                                                                                                 +
    |          | OK                                                                                              |
    +----------+-------------------------------------------------------------------------------------------------+
    |AP Details| - <Serial Number>,<SSID>,<BSSID>,<Channel>,<Signal Strength>,<Encryption Method>                |
    +----------+-------------------------------------------------------------------------------------------------+


AT+CWAUTOCONN
----------------

    +----------+-----------------------------------+--------------------------------------------------------------------+
    |  Command | Read Comamnd                      | Set Command                                                        |
    +          +                                   +                                                                    +
    |          | AT+CWAUTOCONN?                    | AT+CWAUTOCONN=<auto_connect>                                       |
    +          +                                   +                                                                    +
    |          | Purpose: Check autoconnect on/off | Purpose: Set autoconnect on/off                                    |
    +----------+-----------------------------------+--------------------------------------------------------------------+
    | Response | +CWAUTOCONN:<auto_connect>        | OK                                                                 |
    +----------+-----------------------------------+--------------------------------------------------------------------+
    |Parameters| - <auto_connect>:                                                                                      |
    +          +                                                                                                        +
    |          |    * 0: When the Wi-Fi mode is changed to Station or SoftAP+Station, do not automatically connect      |
    +          +                                                                                                        +
    |          |    * 1: When the Wi-Fi mode is changed to Station or SoftAP+Station, automatically connect             |
    +----------+--------------------------------------------------------------------------------------------------------+


AT+CWJAP
----------

    +----------+------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------+
    |  Command | Read Command                                                                             | Set Command                                                                                 |
    +          +                                                                                          +                                                                                             +
    |          | AT+CWJAP?                                                                                | AT+CWJAP=<ssid>,<pwd>                                                                       |
    +          +                                                                                          +                                                                                             +
    |          | Purpose: Get information about the AP the BL602 is connected to                          | Purpose: Set which AP the BL602 should connect to                                           |
    +----------+------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------+
    | Response | +CWJAP:<ssid>,<ip>                                                                       | OK                                                                                          |
    +          +                                                                                          +                                                                                             +
    |          | OK                                                                                       | +EVT:0:wifi connected                                                                       |
    +----------+------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------+
    |Parameters| - <ssid>: String containing the SSID of the connected AP                                 | - <ssid>: SSID of target AP                                                                 |
    +          +                                                                                          +                                                                                             +
    |          |                                                                                          | - <pwd>: The password of the target AP                                                      |
    +          +                                                                                          +                                                                                             +
    |          | - <ip>: The IP address obtained from the AP                                              |   * If either parameter contains any special characters like " or , they need to be escaped |
    +----------+------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------+

AT+CWQAP
-----------

    +----------+-----------------------------------------------------------------------------+
    |  Command |  Set command                                                                |
    +          +                                                                             +
    |          |  AT+CWQAP=<link id>                                                         |
    +----------+-----------------------------------------------------------------------------+
    | Response | OK                                                                          |
    +----------+-----------------------------------------------------------------------------+

AT+SOFTAP
----------

    +----------+------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------+
    |  Command | Read Command                                                                             | Set Command                                                                                 |
    +          +                                                                                          +                                                                                             +
    |          | AT+SOFTAP?                                                                               | AT+SOFTAP=<ssid>,[pwd]                                                                      |
    +          +                                                                                          +                                                                                             +
    |          | Purpose: View the hotspot configuration                                                  | Purpose: Set the hotspot configuration                                                      |
    +----------+------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------+
    | Response | +SOFTAP:<ip>,<bssid>                                                                     | OK                                                                                          |
    +          +                                                                                          +                                                                                             +
    |          | OK                                                                                       |                                                                                             |
    +----------+------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------+
    |Parameters| - <ip>: IP address of the open hotspot                                                   | - <ssid>: SSID for the created hotspot                                                      |
    +          +                                                                                          +                                                                                             +
    |          |                                                                                          | - [pwd]: Password for AP. If omitted, the hotspot is an open AP                             |
    +          +                                                                                          +                                                                                             +
    |          | - <bssid>: MAC address of the open hotspot                                               |   * If either parameter contains any special characters like " or , they need to be escaped |
    +----------+------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------+


====================
TCP/IP AT Commands
====================
Overview
=================
.. table:: Command List

    +-----------------+----------------------------------------------+
    |  Command        | Description                                  |
    +=================+==============================================+
    | `AT+CIPSTART`_  | Establish TCP connection or UDP transmission |
    +-----------------+----------------------------------------------+
    | `AT+CIPCLOSE`_  | Close TCP connection or UDP transmission     |
    +-----------------+----------------------------------------------+
    | `AT+CIPSERVER`_ | Create or shutdown a TCP server              |
    +-----------------+----------------------------------------------+
    | `AT+CIPSEND`_   | Send TCP/IP data                             |
    +-----------------+----------------------------------------------+
    | `+IPD`_         | Receive TCP/IP data                          |
    +-----------------+----------------------------------------------+

Description
===================
AT+CIPSTART
-------------------
.. table:: Establish TCP/UDP connection

    +------------+-----------------------------------------------------------------------------------------------------------------------------------------------+
    | Set Command|  AT+CIPSTART=<link id>,<type>,<remote IP>,<remote port>                                                                                       |
    +------------+-----------------------------------------------------------------------------------------------------------------------------------------------+
    | Response   | OK                                                                                                                                            |
    +            +                                                                                                                                               +
    |            | Or, if a TCP connection has been established, response: ALREADY CONNECTTED ERROR                                                              |
    +------------+-----------------------------------------------------------------------------------------------------------------------------------------------+
    | Parameters | - <link id>: The link ID to be set up                                                                                                         |
    +            +                                                                                                                                               +
    |            | - <type>: String parameter: "TCP or "UDP"                                                                                                     |
    +            +                                                                                                                                               +
    |            | - <remote IP>: String parameter: remote IP address to connect to                                                                              |
    +            +                                                                                                                                               +
    |            | - <remote port>: Remote port number                                                                                                           |
    +------------+-----------------------------------------------------------------------------------------------------------------------------------------------+
    | Examples   | AT+CIPSTART=0,TCP,192.168.101,8000                                                                                                            |
    +            +                                                                                                                                               +
    |            | AT+CIPSTART=1,UDP,192.168.101,5000                                                                                                            |
    +------------+-----------------------------------------------------------------------------------------------------------------------------------------------+

AT+CIPCLOSE
-----------------

    +-----------+------------------------------------------------------------------+
    | Command   |  Set command:                                                    |
    +           +                                                                  +
    |           |  AT+CIPCLOSE=<link id>                                           |
    +-----------+------------------------------------------------------------------+
    | Response  | OK                                                               |
    +-----------+------------------------------------------------------------------+
    | Parameters| - <link id>: The link ID to be closed                            |
    +-----------+------------------------------------------------------------------+

AT+CIPSERVER
----------------

    +----------+------------------------------------------------------------------+
    |  Command |  Set Command:                                                    |
    +          +                                                                  +
    |          |  AT+CIPSERVER=<mode>[,<port>]                                    |
    +----------+------------------------------------------------------------------+
    | Response | OK                                                               |
    +----------+------------------------------------------------------------------+
    |Parameters| - <mode>:                                                        |
    +          +                                                                  +
    |          |    * 0: Shutdown server                                          |
    +          +                                                                  +
    |          |    * 1: Start  server                                            |
    +          +                                                                  +
    |          | - <port>: Port number, default is 333                            |
    +          +                                                                  +
    +----------+------------------------------------------------------------------+
    | Examples | // Start a TCP server listening on port 80                       |
    +          +                                                                  +
    |          |    AT+CIPSERVER=1,80                                             |
    +          +                                                                  +
    +----------+------------------------------------------------------------------+

AT+CIPSEND
----------------

    +----------+------------------------------------------------------------------+
    |  Command |  Set Command:                                                    |
    +          +                                                                  +
    |          |  AT+CIPSEND=<link id>,<data len>                                 |
    +----------+------------------------------------------------------------------+
    | Response | OK                                                               |
    +----------+------------------------------------------------------------------+
    |Parameters| - <link id>: Which link ID to send data on                       |
    +          +                                                                  +
    |          | - <data len>: The length of data to be transmitted in bytes      |
    +          +                                                                  +
    +----------+------------------------------------------------------------------+
    | Examples |   AT+CIPSEND=0,20                                                |
    +          +                                                                  +
    |          | Indicates that 20 bytes will be sent to the connection with id 0 |
    +          +                                                                  +
    +----------+------------------------------------------------------------------+

+IPD
----------------

    +-----------+------------------------------------------------------------------+
    |Description| +IPD is the response when receiving TCP/UDP peer connection data |
    +           +                                                                  +
    |           | +IPD:<link id>,<data len>                                        |
    +           +                                                                  +
    |           | <data>                                                           |
    +-----------+------------------------------------------------------------------+
    |Parameters | - <link id>: ID of the link that the data was received on        |
    +           +                                                                  +
    |           | - <data len>: The length of the data to be received in bytes     |
    +           +                                                                  +
    |           | - <data>: The data received                                      |
    +-----------+------------------------------------------------------------------+


====================
BLE AT Commands
====================
Overview
=================
.. table:: Command List

    +------------------+------------------------------------------+
    |  Command         | Description                              |
    +------------------+------------------------------------------+
    | `AT+BLEDATALEN`_ | Set BLE packet length                    |
    +------------------+------------------------------------------+
    | `AT+BLENAME`_    | Set BLE device name                      |
    +------------------+------------------------------------------+
    | `AT+BLEADDR`_    | Set BLE device address                   |
    +------------------+------------------------------------------+

Description
===================
AT+BLEDATALEN
---------------------

    +----------+------------------------------------------------------------------+
    |  Command |  Set Command:                                                    |
    +          +                                                                  +
    |          |  AT+BLEDATALEN=<conn_index>,<pkt_data_len>                       |
    +          +                                                                  +
    |          |  Purpose: Set the BLE data packet length                         |
    +----------+------------------------------------------------------------------+
    | Response | OK                                                               |
    +----------+------------------------------------------------------------------+
    |Parameters| - <conn_index>: BLE connection number, range [0-2].              |
    +          +                                                                  +
    |          | - <pkt_data_len>: Data packet length, range: 0x001b - 0x00fb     |
    +----------+------------------------------------------------------------------+
    | Notes    | - Need to establish a BLE connection before setting data length  |
    +----------+------------------------------------------------------------------+
    | Examples | AT+BLEINIT=1   // initialize as client                           |
    +          +                                                                  +
    |          |   AT+BLECONN=0,"24:0a:c4:09:34:23"                               |
    +          +                                                                  +
    |          |  AT+BLEDATALEN=0,30                                              |
    +----------+------------------------------------------------------------------+

AT+BLENAME
----------------

    +----------+-----------------------------+----------------------------------------+
    |  Command | Read Command                | Set Command                            |
    +          +                             +                                        +
    |          | AT+BLENAME?                 | AT+BLENAME=<device_name>               |
    +          +                             +                                        +
    |          | Purpose: Read BLE name      | Purpose: Set the BLE name              |
    +----------+-----------------------------+----------------------------------------+
    | Response | +BLENAME:<device_name>      | OK                                     |
    +          +                             +                                        +
    |          | OK                          |                                        |
    +----------+-----------------------------+----------------------------------------+
    |Parameters| - <device_name>: BLE device name (maximum length is 32)              |
    +----------+-----------------------------+----------------------------------------+

AT+BLEADDR
----------------

    +----------+--------------------------------------------+----------------------------------------+
    |  Command | Read Command                               | Set Command                            |
    +          +                                            +                                        +
    |          | AT+BLEADDR?                                | AT+BLEADDR=<addr_type>[,<random_addr>] |
    +          +                                            +                                        +
    |          | Purpose: Query public address of BLE device| Purpose: Set BLE device address        |
    +----------+--------------------------------------------+----------------------------------------+
    | Response | +BLEADDR:<BLE_public_addr>                 | OK                                     |
    +          +                                            +                                        +
    |          | OK                                         |                                        |
    +----------+--------------------------------------------+----------------------------------------+
    |Parameters| - <addr_type>:                                                                      |
    +          +                                                                                     +
    |          |    * 0: public address                                                              |
    +          +                                                                                     +
    |          |    * 1: random address                                                              |
    +----------+--------------------------------------------+----------------------------------------+
